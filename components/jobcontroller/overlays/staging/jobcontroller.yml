---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: jobcontroller
  namespace: ir
spec:
  template:
    spec:
      serviceAccountName: jobcontroller
      containers:
      - name: jobcontroller
        image: ghcr.io/interactivereduction/jobcontroller@sha256:724eb1658c3b7e50afab8894dc03cedd0ade27fef21a3ceb1f8ec027f52644d1
        env:
        # Non secret env vars
        - name: RUNNER_SHA
          value: fe653e0098e719e197be28bf89dd90e9e20b55ef18b464993f60f5a25943744a
        - name: DB_IP
          value: dbspg03.fds.rl.ac.uk
      volumes:
        - name: archive-mount
          persistentVolumeClaim:
            claimName: jobcontroller-archive-pvc
            readOnly: true