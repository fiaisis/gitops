apiVersion: schemas.vectorized.io/v1alpha1
kind: Schema
metadata:
  name: mo01_nmx
spec:
  subject: mo01_nmx-value
  schemaType: flatbuffers
  schema: "// Schema for event-formation-unit detector monitoring, such as ADC and\n\
    // channel histograms, particle tracks or 'Hits'.\n// Sent periodically (typically\
    \ once per second or so) by the\n// detector pipelines to Kafka and consumed by\
    \ Daquiri for visualisation.\n// Useful for debugging, commissioning and testing\
    \ but not necessarily an\n// essential service provided when ESS becomes fully\
    \ operational.\n\nfile_identifier \"mo01\";\n\n// GEMHist is used by gdgem, sonde,\
    \ multiblade for adc and channel histograms in HistSerializer.cpp\n// https://github.com/ess-dmsc/event-formation-unit/blob/master/prototype2/common/HistSerializer.cpp\n\
    // GEMTrack is used by gdgem for particle tracks in TrackSerializer.cpp\n// https://github.com/ess-dmsc/event-formation-unit/blob/master/prototype2/gdgem/nmx/TrackSerializer.cpp\n\
    // MONHit is used by multigrid for streaming readouts in ReadoutSerializer.cpp\n\
    // https://github.com/ess-dmsc/event-formation-unit/blob/master/prototype2/common/ReadoutSerializer.cpp\n\
    \n\nunion DataField { GEMHist, GEMTrack, MONHit }\n\n// used for GEMTrack\ntable\
    \ pos {\n    time : ushort;  // Arbitrary units, could be ns or clock ticks\n\
    \    strip: ushort;  // An index along one axis\n    adc  : ushort;  // ADC value\
    \ from digitiser or other intensity/weight\n}\n\n//\ntable MONHit {\n    plane\
    \   : [ushort];  // A coordinate dimension (x, y, z) or detector dimension (wires,\
    \ strips)\n    time    : [uint];    // Arbitrary units, could be ns or clock ticks\n\
    \    channel : [ushort];  // a channels representing a 'position' along the plane\n\
    \    adc     : [ushort];  // ADC value from digitiser or other intensity/weight\n\
    }\n\ntable GEMTrack {\n    time_offset : ulong;  //\n    xtrack      : [pos];\
    \  // Particle track projection on x\n    ytrack      : [pos];  // Particle track\
    \ projection on y\n    xpos        : double; // Calculated neutron entry position,\
    \ x-coord\n    ypos        : double; // Calculated neutron entry position, y-coord\n\
    }\n\ntable GEMHist {\n    xstrips   : [uint]; // Histogram counts along x-coord\n\
    \    ystrips   : [uint]; // Histogram counts along y-coord\n    xspectrum : [uint];\n\
    \    yspectrum : [uint];\n    cluster_spectrum : [uint];\n    bin_width      \
    \  : uint;\n}\n\ntable MonitorMessage {\n    source_name : string;\n    data :\
    \ DataField;\n}\n\nroot_type MonitorMessage;\n"
